version: '3'

services:
   postgres:
      image: postgres:15
      volumes:
         - postgres-data:/var/lib/postgresql/data
      ports:
         - "16666:5432"
      environment:
         - POSTGRES_DATABASE=keycloak
         - POSTGRES_USER=keycloak
         - POSTGRES_PASSWORD=password
         - POSTGRES_ROOT_PASSWORD=root_password
      networks:
         - pg
      restart: unless-stopped


   keycloak:
      image: quay.io/keycloak/keycloak:23.0.3
      ports:
         - 8888:8080
      environment:
         # Know about the database
         - DB_VENDOR=postgres
         - DB_ADDR=postgres
         - DB_DATABASE=keycloak
         - DB_USER=keycloak
         - DB_PASSWORD=password
         - KEYCLOAK_USER=admin
         - KEYCLOAK_PASSWORD=admin
         - KEYCLOAK_LOGLEVEL=DEBUG
      depends_on:
         - postgres
      links:
         - postgres
      restart: unless-stopped
      networks:
         - pg

volumes:
   postgres-data:

networks:
   pg:
